---
# Install NetBird using the official install script

- name: Download NetBird install script
  ansible.builtin.get_url:
    url: https://pkgs.netbird.io/install.sh
    dest: /tmp/netbird_install.sh
    mode: '0755'
  tags:
    - netbird
    - netbird-script

- name: Run NetBird install script
  ansible.builtin.shell: /tmp/netbird_install.sh
  args:
    creates: /usr/bin/netbird
  register: netbird_script_result
  changed_when: netbird_script_result.rc == 0
  tags:
    - netbird
    - netbird-script

- name: Remove install script
  ansible.builtin.file:
    path: /tmp/netbird_install.sh
    state: absent
  tags:
    - netbird
    - netbird-script
